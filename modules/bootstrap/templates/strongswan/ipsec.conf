config setup
    uniqueids=never # allow multiple connections per user
    charondebug="ike ${log_level}, knl ${log_level}, cfg ${log_level}, net ${log_level}, esp ${log_level}, dmn ${log_level},  mgr ${log_level}"

conn %default
    fragmentation=yes
    rekey=no
    dpdaction=clear
    keyexchange=ikev2
    compress=yes
    dpddelay=35s
    lifetime=3h
    ikelifetime=12h

    ike=${ ciphers.ike }
    esp=${ ciphers.esp }

    left=%any
    leftauth=pubkey
    leftid=${ leftid }
    leftcert=server.pem
    leftsendcert=always
    leftsubnet=0.0.0.0/0,::/0

    rightsourceip=${join(",", rightsourceip)}
    rightdns=${join(",", rightdns)}
    right=127.0.0.1 # A simple way to prevent connections from users not explicitly defined below

%{ for c in ipsec_conns ~}
conn ${c.rightid}
    rightauth=pubkey
    rightid=${c.rightid}
    right=%any
    auto=add
%{ endfor }
